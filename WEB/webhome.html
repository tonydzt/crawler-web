<!DOCTYPE html>
<html>
<head>
    <title>Bootstrap 实例</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.1.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap-table/1.13.1/bootstrap-table.css">
    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/popper.js/1.12.5/umd/popper.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/4.1.0/js/bootstrap.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap-table/1.13.1/bootstrap-table.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap-table/1.13.1/locale/bootstrap-table-zh-CN.js"></script>
</head>
<body>
<div class="container">
</div>
<!--导航栏-->
<ul class="nav nav-tabs">
    <li class="nav-item">
        <a class="nav-link active" data-toggle="tab" href="#home">员工维护</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" data-toggle="tab" href="#menu1">解析excel</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" data-toggle="tab" href="#menu2">分配数据</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" data-toggle="tab" href="#menu3">启动crawler</a>
    </li>
</ul>

<div class="tab-content">
    <!--.fade 淡入淡出-->
    <div class="tab-pane active container" id="home">
        <form id="saveEmployee">
            <div class="form-group custom-control-inline">
                <label for="employeeName" class="col-sm-4 control-label">员工姓名:</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="employeeName" name="name" placeholder="张三">
                </div>
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-primary">保存</button>
            </div>
        </form>
    </div>
    <div class="tab-pane fade container" id="menu1">
        <form class="form-horizontal" id="parseExcel">
            <div class="form-group custom-control-inline">
                <label for="excelPath" class="col-sm-5 control-label">Excel文件日期：</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="excelPath" name="path" placeholder="2018-08-12">
                </div>
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-primary">解析</button>
            </div>
        </form>
    </div>
    <div class="tab-pane fade container" id="menu2">
        <form class="form-horizontal" id="assignTask">
            <div class="form-group custom-control-inline">
                <label for="assignPath" class="col-sm-5 control-label">Excel文件日期：</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="assignPath" name="batchNo" placeholder="2018-08-12">
                </div>
            </div>
            <div class="form-group"></div>
        </form>
    </div>
    <div class="tab-pane fade container" id="menu3">
        <form class="form-horizontal" id="crawlerStart">
            <div class="form-group custom-control-inline">
                <label for="assignPath" class="col-sm-8 control-label">启动crawler：</label>
                <div class="col-sm-10">
                    <button type="submit" class="btn btn-primary">启动</button>
                </div>
            </div>
        </form>
    </div>
</div>

<script type="text/javascript">
    $('#saveEmployee').on('submit', function () {
        $.ajax({
            url: "http://localhost:8090/v1/employee/save",
            type: "POST",
            data: getFormJson('#saveEmployee'),
            cache: false,
            async: false,
            contentType: "application/json",
            dataType: "json",
            success: function () {
                alert("保存成功");
            }
        });
    });

    $('#parseExcel').on('submit', function () {
        $.ajax({
            url: "http://localhost:8090/v1/excel/parse",
            type: "POST",
            data: getFormJson('#parseExcel'),
            cache: false,
            async: false,
            contentType: "application/json",
            dataType: "json",
            success: function () {
                alert("解析成功");
            }
        });
    });

    $('#assignTask').on('submit', function () {
        var param = {};
        var assign = {};
        var t = $('#assignTask').serializeArray();
        $.each(t, function () {
            if (this.name === 'batchNo') {
                param['batchNo'] = this.value;
            } else {
                assign[this.name] = this.value;
            }
        });
        param['assign'] = assign;
        // alert(JSON.stringify(param));
        $.ajax({
            url: "http://localhost:8090/v1/assignment/assign",
            type: "POST",
            data: JSON.stringify(param),
            cache: false,
            async: false,
            contentType: "application/json",
            dataType: "json",
            success: function () {
                alert("分配成功");
            }
        });
    });

    $('#crawlerStart').on('submit', function () {
        $.ajax({
            url: "http://localhost:8090/v1/crawler/start",
            type: "POST",
            cache: false,
            async: false,
            contentType: "application/json",
            dataType: "json",
            success: function () {
                alert("启动成功");
            }
        });
    });

    function getFormJson(formName) {
        var d = {};
        var t = $(formName).serializeArray();
        $.each(t, function () {
            d[this.name] = this.value;
        });
        return JSON.stringify(d);
    }

    $(function () {
        var employee = {};
        $.ajax({
            url: "http://localhost:8090/v1/employee/findAll",
            type: "GET",
            cache: false,
            async: false,
            dataType: "json",
            success: function (data) {
                employee = data;
            }
        });
        $.each(employee, function () {
            var str = '    <div class="form-group custom-control-inline">\n' +
                '        <label for="employee" class="col-sm-5 control-label">' + this.name+ ':</label>\n' +
                '    <div class="col-sm-10">\n' +
                '        <input type="number" class="form-control" id="employee" name="' + this.name + '">\n' +
                '        </div>\n' +
                '        </div>\n<div class="form-group"></div>\n';
            $('#assignTask').append(str);
        });

        $('#assignTask').append('            <div class="form-group">\n' +
            '                <button type="submit" class="btn btn-primary">分配</button>\n' +
            '            </div>'
        );
    });
</script>


</body>
</html>